use std::fmt::{Display, Formatter, Result};

use serde::{Deserialize, Serialize};

#[derive(Debug, Clone, PartialEq, Eq)]
pub enum OutputEvent {
    Keyboard {
        code: KeyboardCode,
        event_type: KeyboardEventType, // press, release, hold
    },
}

impl Display for OutputEvent {
    fn fmt(&self, f: &mut Formatter<'_>) -> Result {
        match self {
            Self::Keyboard { code, event_type } => {
                write!(f, "Keyboard: {:?} ({:?})", code, event_type)
            }
        }
    }
}

#[derive(Debug, Clone, Copy, PartialEq, Eq)]
pub enum KeyboardEventType {
    Press,
    Release,
    Hold,
}

/// Platform-agnostic keyboard key codes.
/// These are derived from the `evdev::KeyCode` enum, focusing on standard keyboard keys.
#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]
pub enum KeyboardCode {
    Reserved,
    Escape,
    Num1,
    Num2,
    Num3,
    Num4,
    Num5,
    Num6,
    Num7,
    Num8,
    Num9,
    Num0,
    Minus,
    Equal,
    Backspace,
    Tab,
    Q,
    W,
    E,
    R,
    T,
    Y,
    U,
    I,
    O,
    P,
    LeftBrace,
    RightBrace,
    Enter,
    LeftControl,
    A,
    S,
    D,
    F,
    G,
    H,
    J,
    K,
    L,
    Semicolon,
    Apostrophe,
    Grave,
    LeftShift,
    Backslash,
    Z,
    X,
    C,
    V,
    B,
    N,
    M,
    Comma,
    Dot,
    Slash,
    RightShift,
    KpAsterisk,
    LeftAlt,
    Space,
    CapsLock,
    F1,
    F2,
    F3,
    F4,
    F5,
    F6,
    F7,
    F8,
    F9,
    F10,
    NumLock,
    ScrollLock,
    Kp7,
    Kp8,
    Kp9,
    KpMinus,
    Kp4,
    Kp5,
    Kp6,
    KpPlus,
    Kp1,
    Kp2,
    Kp3,
    Kp0,
    KpDot,
    KpEnter,
    RightControl,
    KpSlash,
    SysRq,
    RightAlt,
    LineFeed,
    Home,
    Up,
    PageUp,
    Left,
    Right,
    End,
    Down,
    PageDown,
    Insert,
    Delete,
    Macro,
    Mute,
    VolumeDown,
    VolumeUp,
    Power,
    KpEqual,
    KpPlusMinus,
    Pause,
    Scale,
    KpComma,
    LeftMeta,
    RightMeta,
    Compose,
    Stop,
    Again,
    Props,
    Undo,
    Front,
    Copy,
    Open,
    Paste,
    Find,
    Cut,
    Help,
    Menu,
    Calc,
    Setup,
    Sleep,
    WakeUp,
    File,
    SendFile,
    DeleteFile,
    Xfer,
    Prog1,
    Prog2,
    Www,
    Msdos,
    Coffee,
    Direction,
    RotateDisplay,
    CycleWindows,
    Mail,
    Bookmarks,
    Computer,
    Back,
    Forward,
    CloseCd,
    EjectCd,
    EjectCloseCd,
    NextSong,
    PlayPause,
    PreviousSong,
    StopCd,
    Record,
    Rewind,
    Phone,
    Iso,
    Config,
    HomePage,
    Refresh,
    Exit,
    Move,
    Edit,
    ScrollUp,
    ScrollDown,
    KpLeftParen,
    KpRightParen,
    New,
    Redo,
    F13,
    F14,
    F15,
    F16,
    F17,
    F18,
    F19,
    F20,
    F21,
    F22,
    F23,
    F24,
    PlayCd,
    PauseCd,
    Prog3,
    Prog4,
    Dashboard,
    Suspend,
    Close,
    Play,
    FastForward,
    BassBoost,
    Print,
    Hp,
    Camera,
    Sound,
    Question,
    Email,
    Chat,
    Search,
    Connect,
    Finance,
    Sport,
    Shop,
    AlterErase,
    Cancel,
    BrightnessDown,
    BrightnessUp,
    Media,
    SwitchVideoMode,
    KbdIllumToggle,
    KbdIllumDown,
    KbdIllumUp,
    Send,
    Reply,
    ForwardMail,
    Save,
    Documents,
    Battery,
    Bluetooth,
    Wlan,
    Uwb,
    Unknown, // Placeholder for any unmapped keys
}

impl Display for KeyboardCode {
    fn fmt(&self, f: &mut Formatter<'_>) -> Result {
        match self {
            Self::Reserved => write!(f, "Reserved"),
            Self::Escape => write!(f, "Escape"),
            Self::Num1 => write!(f, "1"),
            Self::Num2 => write!(f, "2"),
            Self::Num3 => write!(f, "3"),
            Self::Num4 => write!(f, "4"),
            Self::Num5 => write!(f, "5"),
            Self::Num6 => write!(f, "6"),
            Self::Num7 => write!(f, "7"),
            Self::Num8 => write!(f, "8"),
            Self::Num9 => write!(f, "9"),
            Self::Num0 => write!(f, "0"),
            Self::Minus => write!(f, "-"),
            Self::Equal => write!(f, "="),
            Self::Backspace => write!(f, "Backspace"),
            Self::Tab => write!(f, "Tab"),
            Self::Q => write!(f, "Q"),
            Self::W => write!(f, "W"),
            Self::E => write!(f, "E"),
            Self::R => write!(f, "R"),
            Self::T => write!(f, "T"),
            Self::Y => write!(f, "Y"),
            Self::U => write!(f, "U"),
            Self::I => write!(f, "I"),
            Self::O => write!(f, "O"),
            Self::P => write!(f, "P"),
            Self::LeftBrace => write!(f, "["),
            Self::RightBrace => write!(f, "]"),
            Self::Enter => write!(f, "Enter"),
            Self::LeftControl => write!(f, "Left Control"),
            Self::A => write!(f, "A"),
            Self::S => write!(f, "S"),
            Self::D => write!(f, "D"),
            Self::F => write!(f, "F"),
            Self::G => write!(f, "G"),
            Self::H => write!(f, "H"),
            Self::J => write!(f, "J"),
            Self::K => write!(f, "K"),
            Self::L => write!(f, "L"),
            Self::Semicolon => write!(f, ";"),
            Self::Apostrophe => write!(f, "'"),
            Self::Grave => write!(f, "`"),
            Self::LeftShift => write!(f, "Left Shift"),
            Self::Backslash => write!(f, "\\"),
            Self::Z => write!(f, "Z"),
            Self::X => write!(f, "X"),
            Self::C => write!(f, "C"),
            Self::V => write!(f, "V"),
            Self::B => write!(f, "B"),
            Self::N => write!(f, "N"),
            Self::M => write!(f, "M"),
            Self::Comma => write!(f, ","),
            Self::Dot => write!(f, "."),
            Self::Slash => write!(f, "/"),
            Self::RightShift => write!(f, "Right Shift"),
            Self::KpAsterisk => write!(f, "Kp *"),
            Self::LeftAlt => write!(f, "Left Alt"),
            Self::Space => write!(f, "Space"),
            Self::CapsLock => write!(f, "Caps Lock"),
            Self::F1 => write!(f, "F1"),
            Self::F2 => write!(f, "F2"),
            Self::F3 => write!(f, "F3"),
            Self::F4 => write!(f, "F4"),
            Self::F5 => write!(f, "F5"),
            Self::F6 => write!(f, "F6"),
            Self::F7 => write!(f, "F7"),
            Self::F8 => write!(f, "F8"),
            Self::F9 => write!(f, "F9"),
            Self::F10 => write!(f, "F10"),
            Self::NumLock => write!(f, "Num Lock"),
            Self::ScrollLock => write!(f, "Scroll Lock"),
            Self::Kp7 => write!(f, "Kp 7"),
            Self::Kp8 => write!(f, "Kp 8"),
            Self::Kp9 => write!(f, "Kp 9"),
            Self::KpMinus => write!(f, "Kp -"),
            Self::Kp4 => write!(f, "Kp 4"),
            Self::Kp5 => write!(f, "Kp 5"),
            Self::Kp6 => write!(f, "Kp 6"),
            Self::KpPlus => write!(f, "Kp +"),
            Self::Kp1 => write!(f, "Kp 1"),
            Self::Kp2 => write!(f, "Kp 2"),
            Self::Kp3 => write!(f, "Kp 3"),
            Self::Kp0 => write!(f, "Kp 0"),
            Self::KpDot => write!(f, "Kp ."),
            Self::KpEnter => write!(f, "Kp Enter"),
            Self::RightControl => write!(f, "Right Control"),
            Self::KpSlash => write!(f, "Kp /"),
            Self::SysRq => write!(f, "SysRq"),
            Self::RightAlt => write!(f, "Right Alt"),
            Self::LineFeed => write!(f, "Line Feed"),
            Self::Home => write!(f, "Home"),
            Self::Up => write!(f, "Up"),
            Self::PageUp => write!(f, "Page Up"),
            Self::Left => write!(f, "Left"),
            Self::Right => write!(f, "Right"),
            Self::End => write!(f, "End"),
            Self::Down => write!(f, "Down"),
            Self::PageDown => write!(f, "Page Down"),
            Self::Insert => write!(f, "Insert"),
            Self::Delete => write!(f, "Delete"),
            Self::Macro => write!(f, "Macro"),
            Self::Mute => write!(f, "Mute"),
            Self::VolumeDown => write!(f, "Volume Down"),
            Self::VolumeUp => write!(f, "Volume Up"),
            Self::Power => write!(f, "Power"),
            Self::KpEqual => write!(f, "Kp ="),
            Self::KpPlusMinus => write!(f, "Kp +/-"),
            Self::Pause => write!(f, "Pause"),
            Self::Scale => write!(f, "Scale"),
            Self::KpComma => write!(f, "Kp ,"),
            Self::LeftMeta => write!(f, "Left Meta"),
            Self::RightMeta => write!(f, "Right Meta"),
            Self::Compose => write!(f, "Compose"),
            Self::Stop => write!(f, "Stop"),
            Self::Again => write!(f, "Again"),
            Self::Props => write!(f, "Properties"),
            Self::Undo => write!(f, "Undo"),
            Self::Front => write!(f, "Front"),
            Self::Copy => write!(f, "Copy"),
            Self::Open => write!(f, "Open"),
            Self::Paste => write!(f, "Paste"),
            Self::Find => write!(f, "Find"),
            Self::Cut => write!(f, "Cut"),
            Self::Help => write!(f, "Help"),
            Self::Menu => write!(f, "Menu"),
            Self::Calc => write!(f, "Calculator"),
            Self::Setup => write!(f, "Setup"),
            Self::Sleep => write!(f, "Sleep"),
            Self::WakeUp => write!(f, "Wake Up"),
            Self::File => write!(f, "File"),
            Self::SendFile => write!(f, "Send File"),
            Self::DeleteFile => write!(f, "Delete File"),
            Self::Xfer => write!(f, "Transfer"),
            Self::Prog1 => write!(f, "Program 1"),
            Self::Prog2 => write!(f, "Program 2"),
            Self::Www => write!(f, "WWW"),
            Self::Msdos => write!(f, "MS DOS"),
            Self::Coffee => write!(f, "Coffee"),
            Self::Direction => write!(f, "Direction"),
            Self::RotateDisplay => write!(f, "Rotate Display"),
            Self::CycleWindows => write!(f, "Cycle Windows"),
            Self::Mail => write!(f, "Mail"),
            Self::Bookmarks => write!(f, "Bookmarks"),
            Self::Computer => write!(f, "Computer"),
            Self::Back => write!(f, "Back"),
            Self::Forward => write!(f, "Forward"),
            Self::CloseCd => write!(f, "Close CD"),
            Self::EjectCd => write!(f, "Eject CD"),
            Self::EjectCloseCd => write!(f, "Eject/Close CD"),
            Self::NextSong => write!(f, "Next Song"),
            Self::PlayPause => write!(f, "Play/Pause"),
            Self::PreviousSong => write!(f, "Previous Song"),
            Self::StopCd => write!(f, "Stop CD"),
            Self::Record => write!(f, "Record"),
            Self::Rewind => write!(f, "Rewind"),
            Self::Phone => write!(f, "Phone"),
            Self::Iso => write!(f, "ISO"),
            Self::Config => write!(f, "Configuration"),
            Self::HomePage => write!(f, "Home Page"),
            Self::Refresh => write!(f, "Refresh"),
            Self::Exit => write!(f, "Exit"),
            Self::Move => write!(f, "Move"),
            Self::Edit => write!(f, "Edit"),
            Self::ScrollUp => write!(f, "Scroll Up"),
            Self::ScrollDown => write!(f, "Scroll Down"),
            Self::KpLeftParen => write!(f, "Kp ("),
            Self::KpRightParen => write!(f, "Kp )"),
            Self::New => write!(f, "New"),
            Self::Redo => write!(f, "Redo"),
            Self::F13 => write!(f, "F13"),
            Self::F14 => write!(f, "F14"),
            Self::F15 => write!(f, "F15"),
            Self::F16 => write!(f, "F16"),
            Self::F17 => write!(f, "F17"),
            Self::F18 => write!(f, "F18"),
            Self::F19 => write!(f, "F19"),
            Self::F20 => write!(f, "F20"),
            Self::F21 => write!(f, "F21"),
            Self::F22 => write!(f, "F22"),
            Self::F23 => write!(f, "F23"),
            Self::F24 => write!(f, "F24"),
            Self::PlayCd => write!(f, "Play CD"),
            Self::PauseCd => write!(f, "Pause CD"),
            Self::Prog3 => write!(f, "Program 3"),
            Self::Prog4 => write!(f, "Program 4"),
            Self::Dashboard => write!(f, "Dashboard"),
            Self::Suspend => write!(f, "Suspend"),
            Self::Close => write!(f, "Close"),
            Self::Play => write!(f, "Play"),
            Self::FastForward => write!(f, "Fast Forward"),
            Self::BassBoost => write!(f, "Bass Boost"),
            Self::Print => write!(f, "Print"),
            Self::Hp => write!(f, "HP"),
            Self::Camera => write!(f, "Camera"),
            Self::Sound => write!(f, "Sound"),
            Self::Question => write!(f, "Question"),
            Self::Email => write!(f, "Email"),
            Self::Chat => write!(f, "Chat"),
            Self::Search => write!(f, "Search"),
            Self::Connect => write!(f, "Connect"),
            Self::Finance => write!(f, "Finance"),
            Self::Sport => write!(f, "Sport"),
            Self::Shop => write!(f, "Shop"),
            Self::AlterErase => write!(f, "Alternate Erase"),
            Self::Cancel => write!(f, "Cancel"),
            Self::BrightnessDown => write!(f, "Brightness Down"),
            Self::BrightnessUp => write!(f, "Brightness Up"),
            Self::Media => write!(f, "Media"),
            Self::SwitchVideoMode => write!(f, "Switch Video Mode"),
            Self::KbdIllumToggle => write!(f, "Keyboard Illumination Toggle"),
            Self::KbdIllumDown => write!(f, "Keyboard Illumination Down"),
            Self::KbdIllumUp => write!(f, "Keyboard Illumination Up"),
            Self::Send => write!(f, "Send"),
            Self::Reply => write!(f, "Reply"),
            Self::ForwardMail => write!(f, "Forward Mail"),
            Self::Save => write!(f, "Save"),
            Self::Documents => write!(f, "Documents"),
            Self::Battery => write!(f, "Battery"),
            Self::Bluetooth => write!(f, "Bluetooth"),
            Self::Wlan => write!(f, "WLAN"),
            Self::Uwb => write!(f, "UWB"),
            Self::Unknown => write!(f, "Unknown"),
        }
    }
}

impl From<&str> for KeyboardCode {
    fn from(s: &str) -> Self {
        match s.to_lowercase().as_str() {
            "reserved" => KeyboardCode::Reserved,
            "escape" => KeyboardCode::Escape,
            "1" => KeyboardCode::Num1,
            "2" => KeyboardCode::Num2,
            "3" => KeyboardCode::Num3,
            "4" => KeyboardCode::Num4,
            "5" => KeyboardCode::Num5,
            "6" => KeyboardCode::Num6,
            "7" => KeyboardCode::Num7,
            "8" => KeyboardCode::Num8,
            "9" => KeyboardCode::Num9,
            "0" => KeyboardCode::Num0,
            "-" => KeyboardCode::Minus,
            "=" => KeyboardCode::Equal,
            "backspace" => KeyboardCode::Backspace,
            "tab" => KeyboardCode::Tab,
            "q" => KeyboardCode::Q,
            "w" => KeyboardCode::W,
            "e" => KeyboardCode::E,
            "r" => KeyboardCode::R,
            "t" => KeyboardCode::T,
            "y" => KeyboardCode::Y,
            "u" => KeyboardCode::U,
            "i" => KeyboardCode::I,
            "o" => KeyboardCode::O,
            "p" => KeyboardCode::P,
            "[" => KeyboardCode::LeftBrace,
            "]" => KeyboardCode::RightBrace,
            "enter" => KeyboardCode::Enter,
            "left control" => KeyboardCode::LeftControl,
            "a" => KeyboardCode::A,
            "s" => KeyboardCode::S,
            "d" => KeyboardCode::D,
            "f" => KeyboardCode::F,
            "g" => KeyboardCode::G,
            "h" => KeyboardCode::H,
            "j" => KeyboardCode::J,
            "k" => KeyboardCode::K,
            "l" => KeyboardCode::L,
            ";" => KeyboardCode::Semicolon,
            "'" => KeyboardCode::Apostrophe,
            "`" => KeyboardCode::Grave,
            "left shift" => KeyboardCode::LeftShift,
            "\\" => KeyboardCode::Backslash,
            "z" => KeyboardCode::Z,
            "x" => KeyboardCode::X,
            "c" => KeyboardCode::C,
            "v" => KeyboardCode::V,
            "b" => KeyboardCode::B,
            "n" => KeyboardCode::N,
            "m" => KeyboardCode::M,
            "," => KeyboardCode::Comma,
            "." => KeyboardCode::Dot,
            "/" => KeyboardCode::Slash,
            "right shift" => KeyboardCode::RightShift,
            "kp *" => KeyboardCode::KpAsterisk,
            "left alt" => KeyboardCode::LeftAlt,
            "space" => KeyboardCode::Space,
            "caps lock" => KeyboardCode::CapsLock,
            "f1" => KeyboardCode::F1,
            "f2" => KeyboardCode::F2,
            "f3" => KeyboardCode::F3,
            "f4" => KeyboardCode::F4,
            "f5" => KeyboardCode::F5,
            "f6" => KeyboardCode::F6,
            "f7" => KeyboardCode::F7,
            "f8" => KeyboardCode::F8,
            "f9" => KeyboardCode::F9,
            "f10" => KeyboardCode::F10,
            "num lock" => KeyboardCode::NumLock,
            "scroll lock" => KeyboardCode::ScrollLock,
            "kp 7" => KeyboardCode::Kp7,
            "kp 8" => KeyboardCode::Kp8,
            "kp 9" => KeyboardCode::Kp9,
            "kp -" => KeyboardCode::KpMinus,
            "kp 4" => KeyboardCode::Kp4,
            "kp 5" => KeyboardCode::Kp5,
            "kp 6" => KeyboardCode::Kp6,
            "kp +" => KeyboardCode::KpPlus,
            "kp 1" => KeyboardCode::Kp1,
            "kp 2" => KeyboardCode::Kp2,
            "kp 3" => KeyboardCode::Kp3,
            "kp 0" => KeyboardCode::Kp0,
            "kp ." => KeyboardCode::KpDot,
            "kp enter" => KeyboardCode::KpEnter,
            "right control" => KeyboardCode::RightControl,
            "kp /" => KeyboardCode::KpSlash,
            "sysrq" => KeyboardCode::SysRq,
            "right alt" => KeyboardCode::RightAlt,
            "line feed" => KeyboardCode::LineFeed,
            "home" => KeyboardCode::Home,
            "up" => KeyboardCode::Up,
            "page up" => KeyboardCode::PageUp,
            "left" => KeyboardCode::Left,
            "right" => KeyboardCode::Right,
            "end" => KeyboardCode::End,
            "down" => KeyboardCode::Down,
            "page down" => KeyboardCode::PageDown,
            "insert" => KeyboardCode::Insert,
            "delete" => KeyboardCode::Delete,
            "macro" => KeyboardCode::Macro,
            "mute" => KeyboardCode::Mute,
            "volume down" => KeyboardCode::VolumeDown,
            "volume up" => KeyboardCode::VolumeUp,
            "power" => KeyboardCode::Power,
            "kp =" => KeyboardCode::KpEqual,
            "kp +/-" => KeyboardCode::KpPlusMinus,
            "pause" => KeyboardCode::Pause,
            "scale" => KeyboardCode::Scale,
            "kp ," => KeyboardCode::KpComma,
            "left meta" => KeyboardCode::LeftMeta,
            "right meta" => KeyboardCode::RightMeta,
            "compose" => KeyboardCode::Compose,
            "stop" => KeyboardCode::Stop,
            "again" => KeyboardCode::Again,
            "properties" => KeyboardCode::Props,
            "undo" => KeyboardCode::Undo,
            "front" => KeyboardCode::Front,
            "copy" => KeyboardCode::Copy,
            "open" => KeyboardCode::Open,
            "paste" => KeyboardCode::Paste,
            "find" => KeyboardCode::Find,
            "cut" => KeyboardCode::Cut,
            "help" => KeyboardCode::Help,
            "menu" => KeyboardCode::Menu,
            "calculator" => KeyboardCode::Calc,
            "setup" => KeyboardCode::Setup,
            "sleep" => KeyboardCode::Sleep,
            "wake up" => KeyboardCode::WakeUp,
            "file" => KeyboardCode::File,
            "send file" => KeyboardCode::SendFile,
            "delete file" => KeyboardCode::DeleteFile,
            "transfer" => KeyboardCode::Xfer,
            "program 1" => KeyboardCode::Prog1,
            "program 2" => KeyboardCode::Prog2,
            "www" => KeyboardCode::Www,
            "ms dos" => KeyboardCode::Msdos,
            "coffee" => KeyboardCode::Coffee,
            "direction" => KeyboardCode::Direction,
            "rotate display" => KeyboardCode::RotateDisplay,
            "cycle windows" => KeyboardCode::CycleWindows,
            "mail" => KeyboardCode::Mail,
            "bookmarks" => KeyboardCode::Bookmarks,
            "computer" => KeyboardCode::Computer,
            "back" => KeyboardCode::Back,
            "forward" => KeyboardCode::Forward,
            "close cd" => KeyboardCode::CloseCd,
            "eject cd" => KeyboardCode::EjectCd,
            "eject/close cd" => KeyboardCode::EjectCloseCd,
            "next song" => KeyboardCode::NextSong,
            "play/pause" => KeyboardCode::PlayPause,
            "previous song" => KeyboardCode::PreviousSong,
            "stop cd" => KeyboardCode::StopCd,
            "record" => KeyboardCode::Record,
            "rewind" => KeyboardCode::Rewind,
            "phone" => KeyboardCode::Phone,
            "iso" => KeyboardCode::Iso,
            "configuration" => KeyboardCode::Config,
            "home page" => KeyboardCode::HomePage,
            "refresh" => KeyboardCode::Refresh,
            "exit" => KeyboardCode::Exit,
            "move" => KeyboardCode::Move,
            "edit" => KeyboardCode::Edit,
            "scroll up" => KeyboardCode::ScrollUp,
            "scroll down" => KeyboardCode::ScrollDown,
            "kp (" => KeyboardCode::KpLeftParen,
            "kp )" => KeyboardCode::KpRightParen,
            "new" => KeyboardCode::New,
            "redo" => KeyboardCode::Redo,
            "f13" => KeyboardCode::F13,
            "f14" => KeyboardCode::F14,
            "f15" => KeyboardCode::F15,
            "f16" => KeyboardCode::F16,
            "f17" => KeyboardCode::F17,
            "f18" => KeyboardCode::F18,
            "f19" => KeyboardCode::F19,
            "f20" => KeyboardCode::F20,
            "f21" => KeyboardCode::F21,
            "f22" => KeyboardCode::F22,
            "f23" => KeyboardCode::F23,
            "f24" => KeyboardCode::F24,
            "play cd" => KeyboardCode::PlayCd,
            "pause cd" => KeyboardCode::PauseCd,
            "program 3" => KeyboardCode::Prog3,
            "program 4" => KeyboardCode::Prog4,
            "dashboard" => KeyboardCode::Dashboard,
            "suspend" => KeyboardCode::Suspend,
            "close" => KeyboardCode::Close,
            "play" => KeyboardCode::Play,
            "fast forward" => KeyboardCode::FastForward,
            "bass boost" => KeyboardCode::BassBoost,
            "print" => KeyboardCode::Print,
            "hp" => KeyboardCode::Hp,
            "camera" => KeyboardCode::Camera,
            "sound" => KeyboardCode::Sound,
            "question" => KeyboardCode::Question,
            "email" => KeyboardCode::Email,
            "chat" => KeyboardCode::Chat,
            "search" => KeyboardCode::Search,
            "connect" => KeyboardCode::Connect,
            "finance" => KeyboardCode::Finance,
            "sport" => KeyboardCode::Sport,
            "shop" => KeyboardCode::Shop,
            "alternate erase" => KeyboardCode::AlterErase,
            "cancel" => KeyboardCode::Cancel,
            "brightness down" => KeyboardCode::BrightnessDown,
            "brightness up" => KeyboardCode::BrightnessUp,
            "media" => KeyboardCode::Media,
            "switch video mode" => KeyboardCode::SwitchVideoMode,
            "keyboard illumination toggle" => KeyboardCode::KbdIllumToggle,
            "keyboard illumination down" => KeyboardCode::KbdIllumDown,
            "keyboard illumination up" => KeyboardCode::KbdIllumUp,
            "send" => KeyboardCode::Send,
            "reply" => KeyboardCode::Reply,
            "forward mail" => KeyboardCode::ForwardMail,
            "save" => KeyboardCode::Save,
            "documents" => KeyboardCode::Documents,
            "battery" => KeyboardCode::Battery,
            "bluetooth" => KeyboardCode::Bluetooth,
            "wlan" => KeyboardCode::Wlan,
            "uwb" => KeyboardCode::Uwb,
            _ => KeyboardCode::Unknown,
        }
    }
}

#[cfg(test)]
mod tests {
    use super::KeyboardCode;

    #[test]
    fn test_from_str_for_keyboard_code() {
        // Test known cases (case-insensitive)
        assert_eq!(KeyboardCode::from("reserved"), KeyboardCode::Reserved);
        assert_eq!(KeyboardCode::from("escape"), KeyboardCode::Escape);
        assert_eq!(KeyboardCode::from("Escape"), KeyboardCode::Escape);
        assert_eq!(KeyboardCode::from("ESCAPE"), KeyboardCode::Escape);

        assert_eq!(KeyboardCode::from("1"), KeyboardCode::Num1);
        assert_eq!(KeyboardCode::from("0"), KeyboardCode::Num0);
        assert_eq!(KeyboardCode::from("q"), KeyboardCode::Q);
        assert_eq!(KeyboardCode::from("Z"), KeyboardCode::Z);

        assert_eq!(KeyboardCode::from("-"), KeyboardCode::Minus);
        assert_eq!(KeyboardCode::from("="), KeyboardCode::Equal);
        assert_eq!(KeyboardCode::from("["), KeyboardCode::LeftBrace);
        assert_eq!(KeyboardCode::from("]"), KeyboardCode::RightBrace);
        assert_eq!(KeyboardCode::from("\\"), KeyboardCode::Backslash);
        assert_eq!(KeyboardCode::from(";"), KeyboardCode::Semicolon);
        assert_eq!(KeyboardCode::from("'"), KeyboardCode::Apostrophe);
        assert_eq!(KeyboardCode::from("`"), KeyboardCode::Grave);
        assert_eq!(KeyboardCode::from(","), KeyboardCode::Comma);
        assert_eq!(KeyboardCode::from("."), KeyboardCode::Dot);
        assert_eq!(KeyboardCode::from("/"), KeyboardCode::Slash);

        assert_eq!(KeyboardCode::from("left control"), KeyboardCode::LeftControl);
        assert_eq!(KeyboardCode::from("Left Control"), KeyboardCode::LeftControl);
        assert_eq!(KeyboardCode::from("LEFT CONTROL"), KeyboardCode::LeftControl);

        assert_eq!(KeyboardCode::from("left shift"), KeyboardCode::LeftShift);
        assert_eq!(KeyboardCode::from("right shift"), KeyboardCode::RightShift);
        assert_eq!(KeyboardCode::from("left alt"), KeyboardCode::LeftAlt);
        assert_eq!(KeyboardCode::from("right alt"), KeyboardCode::RightAlt);
        assert_eq!(KeyboardCode::from("space"), KeyboardCode::Space);
        assert_eq!(KeyboardCode::from("caps lock"), KeyboardCode::CapsLock);
        assert_eq!(KeyboardCode::from("enter"), KeyboardCode::Enter);
        assert_eq!(KeyboardCode::from("backspace"), KeyboardCode::Backspace);
        assert_eq!(KeyboardCode::from("tab"), KeyboardCode::Tab);

        assert_eq!(KeyboardCode::from("f1"), KeyboardCode::F1);
        assert_eq!(KeyboardCode::from("F10"), KeyboardCode::F10);
        assert_eq!(KeyboardCode::from("f13"), KeyboardCode::F13);
        assert_eq!(KeyboardCode::from("F24"), KeyboardCode::F24);

        assert_eq!(KeyboardCode::from("kp *"), KeyboardCode::KpAsterisk);
        assert_eq!(KeyboardCode::from("kp -"), KeyboardCode::KpMinus);
        assert_eq!(KeyboardCode::from("kp +"), KeyboardCode::KpPlus);
        assert_eq!(KeyboardCode::from("kp /"), KeyboardCode::KpSlash);
        assert_eq!(KeyboardCode::from("kp ."), KeyboardCode::KpDot);
        assert_eq!(KeyboardCode::from("kp 0"), KeyboardCode::Kp0);
        assert_eq!(KeyboardCode::from("kp 7"), KeyboardCode::Kp7);
        assert_eq!(KeyboardCode::from("kp enter"), KeyboardCode::KpEnter);
        assert_eq!(KeyboardCode::from("kp ="), KeyboardCode::KpEqual);
        assert_eq!(KeyboardCode::from("kp ("), KeyboardCode::KpLeftParen);
        assert_eq!(KeyboardCode::from("kp )"), KeyboardCode::KpRightParen);

        assert_eq!(KeyboardCode::from("home"), KeyboardCode::Home);
        assert_eq!(KeyboardCode::from("up"), KeyboardCode::Up);
        assert_eq!(KeyboardCode::from("page up"), KeyboardCode::PageUp);
        assert_eq!(KeyboardCode::from("left"), KeyboardCode::Left);
        assert_eq!(KeyboardCode::from("right"), KeyboardCode::Right);
        assert_eq!(KeyboardCode::from("end"), KeyboardCode::End);
        assert_eq!(KeyboardCode::from("down"), KeyboardCode::Down);
        assert_eq!(KeyboardCode::from("page down"), KeyboardCode::PageDown);
        assert_eq!(KeyboardCode::from("insert"), KeyboardCode::Insert);
        assert_eq!(KeyboardCode::from("delete"), KeyboardCode::Delete);

        assert_eq!(KeyboardCode::from("mute"), KeyboardCode::Mute);
        assert_eq!(KeyboardCode::from("volume down"), KeyboardCode::VolumeDown);
        assert_eq!(KeyboardCode::from("volume up"), KeyboardCode::VolumeUp);
        assert_eq!(KeyboardCode::from("play/pause"), KeyboardCode::PlayPause);
        assert_eq!(KeyboardCode::from("next song"), KeyboardCode::NextSong);
        assert_eq!(KeyboardCode::from("previous song"), KeyboardCode::PreviousSong);

        // Test multi-word keys
        assert_eq!(KeyboardCode::from("scroll lock"), KeyboardCode::ScrollLock);
        assert_eq!(KeyboardCode::from("home page"), KeyboardCode::HomePage);
        assert_eq!(KeyboardCode::from("eject/close cd"), KeyboardCode::EjectCloseCd);
        assert_eq!(
            KeyboardCode::from("keyboard illumination toggle"),
            KeyboardCode::KbdIllumToggle
        );
        assert_eq!(
            KeyboardCode::from("Keyboard IllUMinaTion toGGle"),
            KeyboardCode::KbdIllumToggle
        );

        // Test unknown case
        assert_eq!(KeyboardCode::from("nonexistent"), KeyboardCode::Unknown);
        assert_eq!(KeyboardCode::from("random string"), KeyboardCode::Unknown);
        assert_eq!(KeyboardCode::from(""), KeyboardCode::Unknown); // Empty string
        assert_eq!(KeyboardCode::from("unknown"), KeyboardCode::Unknown); // The explicit Unknown variant
    }
}
